# 10. 사전 렌더링과 데이터패칭

### ※ 각 페이지에 필요한 데이터
- 인덱스 페이지 → 추천 도서 데이터, 모든 도서 데이터
- 서치 페이지 → 검색 결과 데이터
- 북 페이지 → 특정 도서의 자세한 데이터
를 실습용 백엔드 서버로부터 실제로 데이터를 불러오는 데이터 패칭 기능을 만듦

### ※ 리액트(React App)에서의 데이터 패칭(백엔드 서버로부터 데이터를 불러오는 경우)
```tsx
import { useState, useEffect } from 'react';

export default function Page() { // ①
  const [state, setState] = useState(); // ②

  const fetchData = async () => { // ③
    const response = await fetch('...');
    const data = await response.json();

    setState(data);
  };

  useEffect(() => { // ④
    fetchData();
  }, []);

  if(!state) return "Loading..."; // ⑤

  return <div>...</div>;
}
```
① 페이지 역할을 하는 컴포넌트 생성
② 불러온 데이터를 보관할 `State` 생성
③ `데이터 패칭 함수 생성`
④ `useEffect`를 사용하여 컴포넌트 마운트 시점에 fetchData 호출
⑤ 데이터 로딩중 일때의 `에외처리`

- React App 데이터 패칭의 단점 
  → 초기 접속 요청부 데이터 로딩까지의 오랜 시간이 걸림
  → 데이터 요청이 컴포넌트가 마운트 된 이후에나 발생되기 때문

### ※ 요약 정리
- React App의 데이터 패칭
  - 컴포넌트 마운트 이후에 발생
  - 데이터 요청 시점이 느려지게 되는 단점 발생

- Next App의 데이터 패칭
  - 사전 렌더링 중 발생함 (당연히 컴포넌트 마운트 이후에도 발생 가능)
  - 데이터 요청 시점이 매우 빨라지는 장점